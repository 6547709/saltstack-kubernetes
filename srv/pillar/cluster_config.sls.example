# https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG-1.10.md#external-dependencies
# https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG-1.11.md#external-dependencies
public-domain: example.com
acme-email: user@example.com
kubernetes:
  common:
    image: quay.io/coreos/hyperkube:v1.10.5_coreos.0
    version: v1.10.5
    addons:
  binary-version: v1.10.5
  domain: cluster.local
  etcd:
    host: 127.0.0.1
    members:
      - host: 172.17.4.51
        name: etcd01
      - host: 172.17.4.52
        name: etcd02
      - host: 172.17.4.53
        name: etcd03
    version: v3.1.12
  master:
    service_addresses: 10.3.0.0/24
    members:
      - host: 172.17.4.101
        name: master01
      - host: 172.17.4.102
        name: master02
      - host: 172.17.4.103
        name: master03
    encryption-key: 'w3RNESCMG+o3GCHTUcrQUUdq6CFV72q/Zik9LAO8uEc='
    token:
      admin: 5ce8e923aca23e4d08da268516007611
      kubelet: 898a8b10ff480c8b03c75bcb46721ba1
      calico: d16601479e50593449efd3dcf86fecba
      kube_scheduler: 8210d5686fa6641198a2288d6c4ce6c2
      kube_controller_manager: 97b8af155b65b4a56e6486e433b7f22b
      kube_proxy: 9a06bc9d7c55ff96bda6468b5fc58614
      bootstrap: a931f97743b3cdf8b066d1ba3c9c6c21
      monitoring: db69e5ab1d5d1107880c7e3bc5a678de
      logging: b6160d80868cdbb90030a5b1248468d2
      dns: d01f24a98873a7dcd2d9a0843bae34a3
    storage:
      engine: rook
      members:
      - host: 172.17.4.201
        name: node01
      - host: 172.17.4.202
        name: node02
      - host: 172.17.4.203
        name: node03
  node:
    runtime:
      provider: docker
      docker:
        version: 17.03.2-ce
        data-dir: /var/lib/docker
      rkt:
        version: 1.29.0
    networking:
      cni-version: v0.7.1
      provider: flannel
      calico:
        version: v3.1.3
        cni-version: v3.1.3
        calicoctl-version: v3.1.3
        controller-version: 3.1-release
        as-number: 64512
        token: hu0daeHais3aCHANGEMEhu0daeHais3a
        ipv4:
          range: 10.2.0.0/16
          nat: true
          ip-in-ip: true
        ipv6:
          enable: false
          nat: true
          interface: enp0s2
          range: fd80:24e2:f998:72d6::/64
      flannel:
        version: v0.10.0-amd64
        ipv4:
          range: 10.2.0.0/16
          interface: enp0s2
  global:
    proxy:
      ipaddr: 172.16.4.251
      port: 8888
    vpnIP-range: 172.16.4.0/24
    pod-network: 10.2.0.0/16
    kubernetes-service-ip: 10.3.0.1
    service-ip-range: 10.3.0.0/24
    cluster-dns: 10.3.0.10
    helm-version: v2.8.2
    dashboard-version: v1.8.3
tinyproxy:
  MaxClients: 200
  MinSpareServers: 10
  MaxSpareServers: 40
  StartServers: 20
  Allow:
    - 127.0.0.1
    - 192.168.0.0/16
    - 172.16.0.0/12
    - 10.0.0.0/8
  ConnectPort:
    - 443
    - 563
    - 6443
    - 2379
    - 2380
keepalived:
  global_defs:
    router_id: LVS_DEVEL
  vrrp_instance:
    VI_1:
      state: MASTER
      interface: wg0
      virtual_router_id: 51
      priority: 100
      advert_int: 1
      authentication:
        auth_type: PASS
        auth_pass: 1111
      virtual_ipaddress:
        - 172.16.4.253
        - 172.16.4.254
  virtual_server:
    0.0.0.0 6443:
      delay_loop: 6
      lb_algo: rr
      lb_kind: NAT
      nat_mask: 255.255.255.0
      persistence_timeout: 50
      protocol: TCP
      real_server:
        172.17.4.101 6443:
          weight: 1
        172.17.4.102 6443:
          weight: 2
        172.17.4.103 6443:
          weight: 3
haproxy:
  enabled: true
  overwrite: True
  defaults:
    timeouts:
      - tunnel        3600s
      - http-request    10s
      - queue           1m
      - connect         10s
      - client          1m
      - server          1m
      - http-keep-alive 10s
      - check 10s
    stats:
      - enable
      - uri: 'admin?stats'
  listens:
    stats:
      bind:
        - "0.0.0.0:18080"
      mode: http
      stats:
        enable: True
        uri: "/admin?stats"
  global:
    ssl-default-bind-ciphers: "ECDHE-RSA-AES128-GCM-SHA256:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-SHA256:ECDHE-RSA-AES256-SHA384"
    ssl-default-bind-options: "no-sslv3 no-tlsv10 no-tlsv11"
  user: haproxy
  group: haproxy
  chroot:
    enable: true
    path: /var/lib/haproxy
  daemon: true
  frontends:
    kubernetes-master:
      bind: "*:6443"
      mode: tcp
      default_backend: kube-apiserver
    kubernetes-ingress:
      bind: "*:80"
      mode: tcp
      default_backend: kubernetes-ingress
    kubernetes-ingress-ssl:
      bind: "*:443"
      mode: tcp
      default_backend: kubernetes-ingress-ssl
  backends:
    kube-apiserver:
      mode: tcp
      balance: source
      sticktable: "type binary len 32 size 30k expire 30m"
      servers:
        master01:
          host: 172.17.4.101
          port: 6443
          check: check
        master02:
          host: 172.17.4.102
          port: 6443
          check: check
        master03:
          host: 172.17.4.103
          port: 6443
          check: check
    kubernetes-ingress:
      mode: tcp
      balance: source
      sticktable: "type binary len 32 size 30k expire 30m"
      servers:
        proxy01:
          host: 172.17.4.251
          port: 30080
          check: check
        proxy02:
          host: 172.17.4.252
          port: 30080
          check: check
          extra: backup
    kubernetes-ingress-ssl:
      mode: tcp
      balance: source
      sticktable: "type binary len 32 size 30k expire 30m"
      servers:
        proxy01:
          host: 172.17.4.251
          port: 30443
          check: check
        proxy02:
          host: 172.17.4.252
          port: 30443
          check: check
          extra: backup
