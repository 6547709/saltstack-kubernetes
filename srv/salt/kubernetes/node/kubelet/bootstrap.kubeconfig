{%- from "kubernetes/map.jinja" import master with context -%}

{%- set token = pillar['kubernetes']['global']['kubelet-token'] -%}

apiVersion: v1
kind: Config
clusters:
- cluster:
    certificate-authority: /etc/kubernetes/ssl/ca.pem
    server: https://{{ master.members[0].host }}:6443
  name: kubernetes
contexts:
- context:
    cluster: kubernetes
    user: kubelet
  name: kubelet
current-context: kubelet
users:
- name: kubelet
  user:
    token: {{ token }}
